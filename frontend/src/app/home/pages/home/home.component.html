<div class="home-container">
  <!-- Banner Principal -->
  <section class="main-banner">
    <div class="container">
      <!-- Loading State -->
      <div *ngIf="loading.banners" class="loading-container">
        <div class="loading-spinner"></div>
      </div>

      <!-- Error State -->
      <div *ngIf="error.banners" class="error-message">
        {{ error.banners }}
      </div>

      <!-- Banner Carousel -->
      <app-banner-carousel 
        *ngIf="!loading.banners && !error.banners && banners.length > 0"
        [banners]="banners" 
        [autoPlay]="true" 
        [autoPlayInterval]="5000">
      </app-banner-carousel>

      <!-- Fallback quando não há banners -->
      <div *ngIf="!loading.banners && !error.banners && banners.length === 0" class="no-banners">
        <h1>ADEGA GS</h1>
        <p>Delivery de bebidas na sua porta</p>
        <a routerLink="/produtos" class="cta-button">
          Peça Agora!
        </a>
      </div>
    </div>
  </section>

  <!-- Menu de Categorias Sticky -->
  <div class="categories-wrapper">
    <div class="container">
      <!-- Loading State -->
      <div *ngIf="loading.categories" class="loading-container">
        <div class="loading-spinner"></div>
      </div>

      <!-- Error State -->
      <div *ngIf="error.categories" class="error-message">
        {{ error.categories }}
      </div>

      <!-- Categories Horizontal Scroll -->
      <div *ngIf="!loading.categories && !error.categories" class="categories-scroll">
        <!-- Categoria Combos -->
        <button 
          type="button"
          class="category-pill"
          [class.active]="selectedCategory === null"
          (click)="selectCategory(null)">
          Combos
        </button>
        
        <!-- Outras Categorias -->
        <button 
          type="button"
          *ngFor="let category of categories; trackBy: trackByCategoryId" 
          class="category-pill"
          [class.active]="selectedCategory === category.id"
          (click)="selectCategory(category)">
          {{ category.name }}
        </button>
      </div>
    </div>
  </div>

  <!-- Produtos (Filtrados ou em Destaque) -->
  <section class="featured-products">
    <div class="container">
      <div class="section-header">
        <h2>{{ selectedCategory ? 'Produtos da Categoria' : 'Itens Em Destaque' }}</h2>
        <a routerLink="/produtos" class="view-all">Ver Mais</a>
      </div>

      <!-- Error State -->
      <div *ngIf="error.filtered || error.featured" class="error-message">
        {{ error.filtered || error.featured }}
      </div>

      <!-- Skeleton Screens (Loading State) -->
      <div *ngIf="isLoadingProducts" class="products-grid skeleton-grid">
        <div *ngFor="let item of skeletonItems; let i = index" class="product-card-skeleton">
          <div class="skeleton skeleton-img"></div>
          <div class="skeleton skeleton-text"></div>
          <div class="skeleton skeleton-text" style="width: 60%"></div>
          <div class="skeleton skeleton-price"></div>
          <div class="skeleton skeleton-button"></div>
        </div>
      </div>

      <!-- Products Grid (Real Products) -->
      <div *ngIf="!isLoadingProducts && !loading.featured && !error.filtered && !error.featured" class="products-grid">
        <div *ngFor="let product of filteredProducts; trackBy: trackByProductId" 
             class="product-card">
          <!-- Nome do Produto -->
          <h3 class="product-name">{{ product.name }}</h3>
          
          <!-- Imagem do Produto -->
          <div class="product-image-container">
            <img [src]="getProductImage(product)" [alt]="product.name" class="product-image">
          </div>

          <!-- Preços -->
          <div class="price-container">
            <div *ngIf="product.original_price && product.original_price > product.price" class="price-original">
              R$ {{ product.original_price | number:'1.2-2' }}
            </div>
            <div class="price-current">
              R$ {{ product.price | number:'1.2-2' }}
            </div>
          </div>

          <!-- Botão Adicionar ao Carrinho -->
          <button (click)="addToCart(product)" class="add-to-cart-btn">
            <svg class="cart-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
            </svg>
            <span>Adicionar</span>
          </button>
        </div>
      </div>

      <!-- Empty State -->
      <div *ngIf="!isLoadingProducts && !loading.featured && !error.filtered && !error.featured && filteredProducts.length === 0" 
           class="empty-state">
        {{ selectedCategory ? 'Nenhum produto encontrado nesta categoria.' : 'Nenhum produto em destaque disponível.' }}
      </div>
    </div>
  </section>

  <!-- Combos em Destaque -->
  <section class="featured-combos" *ngIf="featuredCombos.length > 0">
    <div class="container">
      <div class="section-header">
        <h2>Combos Especiais</h2>
        <a routerLink="/combos" class="view-all">Ver Todos</a>
      </div>

      <!-- Loading State -->
      <div *ngIf="loading.combos" class="loading-container">
        <div class="loading-spinner"></div>
      </div>

      <!-- Error State -->
      <div *ngIf="error.combos" class="error-message">
        {{ error.combos }}
      </div>

      <!-- Combos Grid -->
      <div *ngIf="!loading.combos && !error.combos" class="combos-grid">
        <app-combo-card 
          *ngFor="let combo of featuredCombos; trackBy: trackByComboId"
          [combo]="combo"
          (addToCart)="addComboToCart($event)">
        </app-combo-card>
      </div>
    </div>
  </section>

  <!-- Produtos Populares -->
  <section class="popular-products">
    <div class="container">
      <div class="section-header">
        <h2>Itens Mais Populares</h2>
        <a routerLink="/produtos" class="view-all">Ver Mais</a>
      </div>

      <!-- Loading State -->
      <div *ngIf="loading.popular" class="loading-container">
        <div class="loading-spinner"></div>
      </div>

      <!-- Error State -->
      <div *ngIf="error.popular" class="error-message">
        {{ error.popular }}
      </div>

      <!-- Products Grid -->
      <div *ngIf="!loading.popular && !error.popular" class="products-grid">
        <div *ngFor="let product of popularProducts; trackBy: trackByProductId" 
             class="product-card">
          <!-- Nome do Produto -->
          <h3 class="product-name">{{ product.name }}</h3>
          
          <!-- Imagem do Produto -->
          <div class="product-image-container">
            <img [src]="getProductImage(product)" [alt]="product.name" class="product-image">
          </div>

          <!-- Preços -->
          <div class="price-container">
            <div *ngIf="product.original_price && product.original_price > product.price" class="price-original">
              R$ {{ product.original_price | number:'1.2-2' }}
            </div>
            <div class="price-current">
              R$ {{ product.price | number:'1.2-2' }}
            </div>
          </div>

          <!-- Botão Adicionar ao Carrinho -->
          <button (click)="addToCart(product)" class="add-to-cart-btn">
            <svg class="cart-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
            </svg>
            <span>Adicionar</span>
          </button>
        </div>
      </div>

      <!-- Empty State -->
      <div *ngIf="!loading.popular && !error.popular && popularProducts.length === 0" 
           class="empty-state">
        Nenhum produto popular disponível.
      </div>
    </div>
  </section>
</div>