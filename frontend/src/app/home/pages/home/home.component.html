<div class="home-container">
  <!-- Banner Principal -->
  <section class="main-banner">
    <div class="container">
      <!-- Loading State -->
      <div *ngIf="loading.banners" class="loading-container">
        <div class="loading-spinner"></div>
      </div>

      <!-- Error State -->
      <div *ngIf="error.banners" class="error-message">
        {{ error.banners }}
      </div>

      <!-- Banner Carousel -->
      <app-banner-carousel 
        *ngIf="!loading.banners && !error.banners && banners.length > 0"
        [banners]="banners" 
        [autoPlay]="true" 
        [autoPlayInterval]="5000">
      </app-banner-carousel>

      <!-- Fallback quando não há banners -->
      <div *ngIf="!loading.banners && !error.banners && banners.length === 0" class="no-banners">
        <h1>ADEGA GS</h1>
        <p>Delivery de bebidas na sua porta</p>
        <a routerLink="/produtos" class="cta-button">
          Peça Agora!
        </a>
      </div>
    </div>
  </section>

  <!-- Menu de Categorias Sticky -->
  <div class="categories-wrapper">
    <div class="container">
      <!-- Loading State -->
      <div *ngIf="loading.categories" class="loading-container">
        <div class="loading-spinner"></div>
      </div>

      <!-- Error State -->
      <div *ngIf="error.categories" class="error-message">
        {{ error.categories }}
      </div>

      <!-- Categories Horizontal Scroll -->
      <div *ngIf="!loading.categories && !error.categories" class="categories-scroll">
        <!-- Categorias -->
        <button 
          type="button"
          *ngFor="let category of categories; trackBy: trackByCategoryId" 
          class="category-pill"
          [class.active]="selectedCategory === category.id"
          (click)="selectCategory(category)">
          {{ category.name }}
        </button>
      </div>
    </div>
  </div>

  <!-- Produtos (Filtrados ou em Destaque) -->
  <section class="featured-products">
    <div class="container">
      <div class="section-header">
        <h2>{{ selectedCategory ? 'Produtos da Categoria' : 'Itens Em Destaque' }}</h2>
        <a routerLink="/produtos" class="view-all">Ver Mais</a>
      </div>

      <!-- Error State -->
      <div *ngIf="error.filtered || error.featured" class="error-message">
        {{ error.filtered || error.featured }}
      </div>

      <!-- Skeleton Screens (Loading State) -->
      <div *ngIf="isLoadingProducts" class="products-grid skeleton-grid">
        <div *ngFor="let item of skeletonItems; let i = index" class="product-card-skeleton">
          <div class="skeleton skeleton-img"></div>
          <div class="skeleton skeleton-text"></div>
          <div class="skeleton skeleton-text" style="width: 60%"></div>
          <div class="skeleton skeleton-price"></div>
          <div class="skeleton skeleton-button"></div>
        </div>
      </div>

      <!-- Products Grid (Real Products) -->
      <div *ngIf="!isLoadingProducts && !loading.featured && !error.filtered && !error.featured" class="products-grid">
        <app-product-card 
          *ngFor="let product of filteredProducts; trackBy: trackByProductId"
          [product]="product"
          (addToCart)="addToCart($event)">
        </app-product-card>
      </div>

      <!-- Botão Ver Mais -->
      <div *ngIf="!isLoadingProducts && !loading.featured && !error.filtered && !error.featured && currentPage < lastPage" 
           class="load-more-container">
        <button type="button" class="btn-load-more" (click)="loadMore()" [disabled]="isLoadingProducts">
          {{ isLoadingProducts ? 'Carregando...' : 'Ver Mais Produtos' }}
        </button>
      </div>

      <!-- Empty State -->
      <div *ngIf="!isLoadingProducts && !loading.featured && !error.filtered && !error.featured && filteredProducts.length === 0" 
           class="empty-state">
        {{ selectedCategory ? 'Nenhum produto encontrado nesta categoria.' : 'Nenhum produto em destaque disponível.' }}
      </div>
    </div>
  </section>

  <!-- Combos & Ofertas -->
  <section class="combos-section" *ngIf="featuredCombos.length > 0">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title">Combos & Ofertas</h2>
        <a routerLink="/combos" class="view-all">Ver Todos</a>
      </div>

      <!-- Loading State -->
      <div *ngIf="loading.combos" class="loading-container">
        <div class="loading-spinner"></div>
      </div>

      <!-- Error State -->
      <div *ngIf="error.combos" class="error-message">
        {{ error.combos }}
      </div>

      <!-- Combos Grid -->
      <div *ngIf="!loading.combos && !error.combos" class="products-grid">
        <app-product-card 
          *ngFor="let combo of featuredCombos; trackBy: trackByComboId"
          [product]="comboAdapter(combo)"
          (addToCart)="addToCart($event)">
        </app-product-card>
      </div>
    </div>
  </section>

  <!-- Produtos Populares -->
  <section class="popular-products">
    <div class="container">
      <div class="section-header">
        <h2>Itens Mais Populares</h2>
        <a routerLink="/produtos" class="view-all">Ver Mais</a>
      </div>

      <!-- Loading State -->
      <div *ngIf="loading.popular" class="loading-container">
        <div class="loading-spinner"></div>
      </div>

      <!-- Error State -->
      <div *ngIf="error.popular" class="error-message">
        {{ error.popular }}
      </div>

      <!-- Products Grid -->
      <div *ngIf="!loading.popular && !error.popular" class="products-grid">
        <app-product-card 
          *ngFor="let product of popularProducts; trackBy: trackByProductId"
          [product]="product"
          (addToCart)="addToCart($event)">
        </app-product-card>
      </div>

      <!-- Empty State -->
      <div *ngIf="!loading.popular && !error.popular && popularProducts.length === 0" 
           class="empty-state">
        Nenhum produto popular disponível.
      </div>
    </div>
  </section>
</div>