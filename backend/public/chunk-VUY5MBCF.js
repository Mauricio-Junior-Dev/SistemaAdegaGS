import{a as x}from"./chunk-GLCUIYZL.js";import{a as W}from"./chunk-KAYA52NT.js";import{a as J,b as K}from"./chunk-ZVU5WUZE.js";import{b as Q}from"./chunk-2245NF6H.js";import{a as H,c as U,g as Y}from"./chunk-AKZY2JAS.js";import{a as _}from"./chunk-6VK4WP7F.js";import{a as q,b as G}from"./chunk-LUD35HDA.js";import{Y as $,_ as R}from"./chunk-H4HZ2WXW.js";import{a as N}from"./chunk-JEC3ZXLW.js";import{d as B,h as L}from"./chunk-UIAL7XLZ.js";import{$a as p,Bb as i,Cb as e,Db as F,F as E,Gc as T,Hb as A,Ic as z,Kb as j,Lb as u,Rc as V,Wa as r,Wb as n,Xb as m,Yb as g,ba as l,ec as d,fc as v,ga as P,gb as D,l as b,la as f,lb as C,sb as s,ta as I,ua as k,ub as w,w as O,x as M}from"./chunk-QUOLBKI4.js";var y=class a{constructor(o,t,c){this.cashService=o;this.orderService=t;this.stockService=c}getSummary(){return M([this.cashService.getStatus(),this.orderService.getOrdersSummary(),this.stockService.getSummary()]).pipe(O(([o,t,c])=>({sales:{total_amount:t.total_amount,total_orders:t.total_orders},orders:{pending:t.pending,delivering:t.delivering,completed:t.completed},cash:{is_open:o.is_open,current_amount:o.current_amount},stock:{total_products:c.total_products,low_stock_count:c.low_stock_count}})))}static \u0275fac=function(t){return new(t||a)(f(x),f(_),f(W))};static \u0275prov=P({token:a,factory:a.\u0275fac,providedIn:"root"})};var Z=a=>({open:a}),S=()=>["/funcionario/caixa"],tt=()=>["/funcionario/pedidos"],at=a=>({warning:a}),ot=()=>["/funcionario/estoque"];function ct(a,o){a&1&&(i(0,"div",5),F(1,"mat-spinner",6),i(2,"p"),n(3,"Carregando informa\xE7\xF5es..."),e()())}function st(a,o){if(a&1){let t=A();i(0,"div",7)(1,"mat-icon",8),n(2,"error"),e(),i(3,"p"),n(4,"Erro ao carregar informa\xE7\xF5es"),e(),i(5,"button",9),j("click",function(){I(t);let h=u();return k(h.isEmployee?h.loadEmployeeData(!0):h.loadSummary(!0))}),n(6,"Tentar Novamente"),e()()}}function mt(a,o){if(a&1&&(i(0,"p",25),n(1),e()),a&2){let t=u(2);r(),g(" Saldo Atual: ",t.formatCurrency(t.summary.cash.current_amount)," ")}}function dt(a,o){if(a&1&&(i(0,"div",10)(1,"mat-card",11)(2,"mat-card-content")(3,"div",12)(4,"mat-icon"),n(5,"point_of_sale"),e(),i(6,"h2"),n(7,"Status do Caixa"),e()(),i(8,"div",13)(9,"p",14),n(10),e(),C(11,mt,2,1,"p",15),e(),i(12,"div",16)(13,"button",17),n(14),e()()()(),i(15,"mat-card",18)(16,"mat-card-content")(17,"div",12)(18,"mat-icon"),n(19,"payments"),e(),i(20,"h2"),n(21,"Vendas do Dia"),e()(),i(22,"div",13)(23,"div",19)(24,"span",20),n(25,"Total"),e(),i(26,"span",21),n(27),e()(),i(28,"div",19)(29,"span",20),n(30,"Pedidos"),e(),i(31,"span",21),n(32),e()()()()(),i(33,"mat-card",18)(34,"mat-card-content")(35,"div",12)(36,"mat-icon"),n(37,"receipt_long"),e(),i(38,"h2"),n(39,"Status dos Pedidos"),e()(),i(40,"div",13)(41,"div",19)(42,"span",20),n(43,"Pendentes"),e(),i(44,"span",22),n(45),e()(),i(46,"div",19)(47,"span",20),n(48,"Em Entrega"),e(),i(49,"span",21),n(50),e()(),i(51,"div",19)(52,"span",20),n(53,"Finalizados"),e(),i(54,"span",21),n(55),e()()(),i(56,"div",16)(57,"button",17),n(58," Ver Pedidos "),e()()()(),i(59,"mat-card",23)(60,"mat-card-content")(61,"div",12)(62,"mat-icon"),n(63,"inventory_2"),e(),i(64,"h2"),n(65,"Status do Estoque"),e()(),i(66,"div",13)(67,"div",19)(68,"span",20),n(69,"Total de Produtos"),e(),i(70,"span",21),n(71),e()(),i(72,"div",19)(73,"span",20),n(74,"Estoque Baixo"),e(),i(75,"span",24),n(76),e()()(),i(77,"div",16)(78,"button",17),n(79," Gerenciar Estoque "),e()()()()()),a&2){let t=u();r(),s("ngClass",v(15,Z,t.summary.cash.is_open)),r(9),m(t.summary.cash.is_open?"ABERTO":"FECHADO"),r(),s("ngIf",t.summary.cash.is_open),r(2),s("routerLink",d(17,S)),r(),g(" ",t.summary.cash.is_open?"Gerenciar Caixa":"Abrir Caixa"," "),r(13),m(t.formatCurrency(t.summary.sales.total_amount)),r(5),m(t.summary.sales.total_orders),r(13),m(t.summary.orders.pending),r(5),m(t.summary.orders.delivering),r(5),m(t.summary.orders.completed),r(2),s("routerLink",d(18,tt)),r(2),s("ngClass",v(19,at,t.summary.stock.low_stock_count>0)),r(12),m(t.summary.stock.total_products),r(5),m(t.summary.stock.low_stock_count),r(2),s("routerLink",d(21,ot))}}function lt(a,o){if(a&1&&(i(0,"div",26)(1,"mat-card",27)(2,"mat-card-content")(3,"div",12)(4,"mat-icon"),n(5),e(),i(6,"h2"),n(7,"Status do Caixa"),e()(),i(8,"div",13)(9,"p",28),n(10),e()(),i(11,"div",16)(12,"button",29)(13,"mat-icon"),n(14),e(),n(15),e()()()(),i(16,"mat-card",30)(17,"mat-card-content")(18,"div",12)(19,"mat-icon"),n(20,"shopping_cart"),e(),i(21,"h2"),n(22,"Nova Venda"),e()(),i(23,"div",13)(24,"p",31),n(25,"Inicie uma nova venda no PDV"),e()(),i(26,"div",16)(27,"button",32)(28,"mat-icon"),n(29,"add_shopping_cart"),e(),n(30," Ir para o Caixa "),e()()()(),i(31,"mat-card",18)(32,"mat-card-content")(33,"div",12)(34,"mat-icon"),n(35,"receipt_long"),e(),i(36,"h2"),n(37,"Status dos Pedidos"),e()(),i(38,"div",13)(39,"div",19)(40,"span",20),n(41,"Pendentes"),e(),i(42,"span",22),n(43),e()(),i(44,"div",19)(45,"span",20),n(46,"Em Entrega"),e(),i(47,"span",21),n(48),e()(),i(49,"div",19)(50,"span",20),n(51,"Finalizados"),e(),i(52,"span",21),n(53),e()()(),i(54,"div",16)(55,"button",17),n(56," Ver Pedidos "),e()()()()()),a&2){let t=u();r(),s("ngClass",v(16,Z,t.summary.cash.is_open)),r(3),w("open-icon",t.summary.cash.is_open)("closed-icon",!t.summary.cash.is_open),r(),g(" ",t.summary.cash.is_open?"point_of_sale":"lock"," "),r(5),m(t.summary.cash.is_open?"ABERTO":"FECHADO"),r(2),s("color",t.summary.cash.is_open?"primary":"accent")("routerLink",d(18,S)),r(2),m(t.summary.cash.is_open?"point_of_sale":"vpn_key"),r(),g(" ",t.summary.cash.is_open?"Gerenciar Caixa":"Abrir Caixa"," "),r(12),s("routerLink",d(19,S)),r(16),m(t.summary.orders.pending),r(5),m(t.summary.orders.delivering),r(5),m(t.summary.orders.completed),r(2),s("routerLink",d(20,tt))}}var X=class a{constructor(o,t,c,h){this.dashboardService=o;this.authService=t;this.cashService=c;this.orderService=h}summary=null;cashStatus=null;loading=!0;error=!1;isEmployee=!1;isAdmin=!1;destroy$=new b;ngOnInit(){this.isEmployee=this.authService.isEmployee()&&!this.authService.isAdmin(),this.isAdmin=this.authService.isAdmin(),this.isEmployee?this.loadEmployeeData(!0):this.loadSummary(!0),E(15e3).pipe(l(this.destroy$)).subscribe(()=>{this.isEmployee?this.loadEmployeeData(!1):this.loadSummary(!1)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadSummary(o=!0){o&&(this.loading=!0),this.error=!1,this.dashboardService.getSummary().pipe(l(this.destroy$)).subscribe({next:t=>{this.summary=t,o&&(this.loading=!1)},error:t=>{console.error("Erro ao carregar dashboard:",t),this.error=!0,o&&(this.loading=!1)}})}loadEmployeeData(o=!0){o&&(this.loading=!0),this.error=!1,this.cashService.getStatus().pipe(l(this.destroy$)).subscribe({next:t=>{this.cashStatus=t,this.orderService.getOrdersSummary().pipe(l(this.destroy$)).subscribe({next:c=>{this.summary={sales:{total_amount:0,total_orders:0},orders:{pending:c.pending,delivering:c.delivering,completed:c.completed},cash:{is_open:t.is_open,current_amount:t.current_amount},stock:{total_products:0,low_stock_count:0}},o&&(this.loading=!1)},error:c=>{console.error("Erro ao carregar pedidos:",c),this.error=!0,o&&(this.loading=!1)}})},error:t=>{console.error("Erro ao carregar status do caixa:",t),this.error=!0,o&&(this.loading=!1)}})}formatCurrency(o){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(o)}static \u0275fac=function(t){return new(t||a)(p(y),p(N),p(x),p(_))};static \u0275cmp=D({type:a,selectors:[["app-dashboard"]],decls:7,vars:4,consts:[[1,"dashboard-container"],["class","loading-container",4,"ngIf"],["class","error-container",4,"ngIf"],["class","dashboard-content",4,"ngIf"],["class","dashboard-content employee-dashboard",4,"ngIf"],[1,"loading-container"],["diameter","50"],[1,"error-container"],["color","warn"],["mat-raised-button","","color","primary",3,"click"],[1,"dashboard-content"],[1,"status-card",3,"ngClass"],[1,"card-header"],[1,"card-body"],[1,"status"],["class","amount",4,"ngIf"],[1,"card-actions"],["mat-raised-button","","color","primary",3,"routerLink"],[1,"summary-card"],[1,"stat"],[1,"label"],[1,"value"],[1,"value","highlight"],[1,"summary-card",3,"ngClass"],[1,"value","warning"],[1,"amount"],[1,"dashboard-content","employee-dashboard"],[1,"status-card","highlight-card",3,"ngClass"],[1,"status-large"],["mat-raised-button","",1,"action-button-large",3,"color","routerLink"],[1,"summary-card","action-card"],[1,"card-description"],["mat-raised-button","","color","primary",1,"action-button-large",3,"routerLink"]],template:function(t,c){t&1&&(i(0,"div",0)(1,"h1"),n(2,"Dashboard"),e(),C(3,ct,4,0,"div",1)(4,st,7,0,"div",2)(5,dt,80,22,"div",3)(6,lt,57,21,"div",4),e()),t&2&&(r(3),s("ngIf",c.loading),r(),s("ngIf",c.error),r(),s("ngIf",!c.loading&&!c.error&&c.summary&&c.isAdmin),r(),s("ngIf",!c.loading&&!c.error&&c.summary&&c.isEmployee))},dependencies:[V,T,z,L,B,Y,H,U,R,$,G,q,Q,K,J],styles:[".dashboard-container[_ngcontent-%COMP%]{padding:20px}h1[_ngcontent-%COMP%]{margin-bottom:24px;font-size:24px;font-weight:500;color:#000000de}.dashboard-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px}.status-card[_ngcontent-%COMP%], .summary-card[_ngcontent-%COMP%]{height:100%;transition:transform .2s,box-shadow .2s}.status-card[_ngcontent-%COMP%]:hover, .summary-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 8px #0000001a}.card-header[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:16px}.card-header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px;color:#1976d2}.card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:500}.card-body[_ngcontent-%COMP%]{margin-bottom:16px}.status-card.open[_ngcontent-%COMP%]{border-left:4px solid #4caf50}.status-card[_ngcontent-%COMP%]:not(.open){border-left:4px solid #f44336}.status[_ngcontent-%COMP%]{font-size:24px;font-weight:500;margin-bottom:8px}.open[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{color:#4caf50}.amount[_ngcontent-%COMP%]{font-size:20px;color:#1976d2}.stat[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;padding:8px 0;border-bottom:1px solid rgba(0,0,0,.12)}.stat[_ngcontent-%COMP%]:last-child{border-bottom:none}.stat[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#0009}.stat[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:500;font-size:18px}.stat[_ngcontent-%COMP%]   .value.highlight[_ngcontent-%COMP%]{color:#1976d2}.stat[_ngcontent-%COMP%]   .value.warning[_ngcontent-%COMP%]{color:#f44336}.warning[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#f44336}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:16px;color:#0009}.error-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;text-align:center}.error-container[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;height:48px;width:48px;margin-bottom:16px}.error-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:16px;color:#0009}.card-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:16px}.employee-dashboard[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(280px,1fr))}.highlight-card[_ngcontent-%COMP%]{grid-column:span 2;background:linear-gradient(135deg,#ff9149,#ffecdb);color:#fff}.highlight-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .highlight-card[_ngcontent-%COMP%]   .status-large[_ngcontent-%COMP%]{color:#fff}.highlight-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff}.highlight-card.open[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4caf50,#81c784)}.highlight-card[_ngcontent-%COMP%]:not(.open){background:linear-gradient(135deg,#f44336,#e57373)}.status-large[_ngcontent-%COMP%]{font-size:36px;font-weight:700;margin:16px 0;text-align:center}.action-card[_ngcontent-%COMP%]{background-color:#f5f5f5}.action-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--primary)}.card-description[_ngcontent-%COMP%]{color:#0009;font-size:14px;margin:8px 0}.action-button-large[_ngcontent-%COMP%]{width:100%;height:56px;font-size:16px;font-weight:500}.action-button-large[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.open-icon[_ngcontent-%COMP%]{color:#4caf50!important}.closed-icon[_ngcontent-%COMP%]{color:#f44336!important}@media (max-width: 599px){.dashboard-content[_ngcontent-%COMP%]{grid-template-columns:1fr}.highlight-card[_ngcontent-%COMP%]{grid-column:span 1}.stat[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.stat[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{margin-top:4px}}"]})};export{X as DashboardComponent};
