import{a as E}from"./chunk-EHNS2L7Y.js";import{a as $,b as j}from"./chunk-OZHJ4RLB.js";import{T as z,_ as T}from"./chunk-E25F7JMY.js";import{h as S}from"./chunk-RCLABZBX.js";import{h as w}from"./chunk-UI7OC72Q.js";import{$a as g,Bb as r,Cb as c,Da as x,Db as P,Ic as y,Kb as v,Lb as h,Oc as M,Pc as O,Rc as k,Ua as C,Wa as o,Wb as p,Xb as b,Yb as m,cd as I,gb as _,hc as l,jc as u,lb as f,sb as d}from"./chunk-G6OUGGHL.js";function W(a,e){if(a&1&&(r(0,"div",11),p(1),l(2,"number"),c()),a&2){let t=h();o(),m(" ",u(2,1,t.getDiscountPercentage(),"1.0-0"),"% OFF ")}}function q(a,e){if(a&1&&(r(0,"span",12),p(1),l(2,"currency"),c()),a&2){let t=h();o(),m(" ",u(2,1,t.product.original_price,"BRL")," ")}}var B=class a{constructor(e,t){this.cartService=e;this.toastr=t}product;addToCart=new x;onAddToCart(e){if(e.preventDefault(),e.stopPropagation(),this.product.category_id===0&&this.product.doses_por_garrafa===0&&this.product.current_stock===999){this.addToCart.emit(this.product);return}let i=this.getCurrentQuantity();if(this.cartService.addItem(this.product,1),i===0){let n=this.product.name,U=n.toLowerCase().endsWith("a")||n.toLowerCase().endsWith("\xE3o")||n.toLowerCase().endsWith("ade")?`${n} adicionada!`:`${n} adicionado!`;this.toastr.success(U,"",{timeOut:1500,positionClass:"toast-bottom-center",progressBar:!1})}this.addToCart.emit(this.product)}getCurrentQuantity(){let i=(this.cartService.getCartState()?.items||[]).find(n=>n.id===this.product.id);return i?i.quantity:0}getImageUrl(e){let t=e.image_url;if(t){if(t.startsWith("http://")||t.startsWith("https://"))return`${t}?v=${encodeURIComponent(e.updated_at)}`;if(t.startsWith("/storage/")||t.startsWith("storage/")){let n=I.apiUrl.replace(/\/api$/,""),s=t.startsWith("/")?t:`/${t}`;return`${n}${s}?v=${encodeURIComponent(e.updated_at)}`}return`${t}?v=${encodeURIComponent(e.updated_at)}`}let i=e.images?.[0];return i||"assets/images/no-image.jpg"}getLowStock(e){let t=e.current_stock??0,i=e.min_stock??0;return t<=i}hasLowStock(e){let t=e.current_stock??0;return t<5&&t>0}getStockMessage(e){let t=e.current_stock??0;return t<5&&t>0?`Restam apenas ${t} unidades`:""}hasOffer(e){let t=e.original_price;return t&&t>e.price}getOriginalPrice(e){return e.original_price||e.price}getDiscountPercentage(){let e=this.product.original_price;return!e||e<=this.product.price?0:Math.round((e-this.product.price)/e*100)}static \u0275fac=function(t){return new(t||a)(g(E),g(S))};static \u0275cmp=_({type:a,selectors:[["app-product-card"]],inputs:{product:"product"},outputs:{addToCart:"addToCart"},decls:16,vars:10,consts:[[1,"product-card"],["class","discount-tag",4,"ngIf"],[1,"card-content"],[1,"card-image-container"],[1,"card-img",3,"src","alt"],[1,"product-title",3,"title"],[1,"card-footer"],[1,"price-block"],["class","old-price",4,"ngIf"],[1,"current-price"],["mat-icon-button","","aria-label","Adicionar ao carrinho",1,"btn-quick-add",3,"click"],[1,"discount-tag"],[1,"old-price"]],template:function(t,i){t&1&&(r(0,"div",0),f(1,W,3,4,"div",1),r(2,"div",2)(3,"div",3),P(4,"img",4),c(),r(5,"h3",5),p(6),c()(),r(7,"div",6)(8,"div",7),f(9,q,3,4,"span",8),r(10,"span",9),p(11),l(12,"currency"),c()(),r(13,"button",10),v("click",function(s){return i.onAddToCart(s)}),r(14,"mat-icon"),p(15,"add_shopping_cart"),c()()()()),t&2&&(o(),d("ngIf",i.product.original_price&&i.product.original_price>i.product.price),o(3),d("src",i.getImageUrl(i.product),C)("alt",i.product.name),o(),d("title",i.product.name),o(),b(i.product.name),o(3),d("ngIf",i.product.original_price&&i.product.original_price>i.product.price),o(2),m(" ",u(12,7,i.product.price,"BRL")," "))},dependencies:[k,y,M,O,w,j,$,T,z],styles:["[_nghost-%COMP%]{display:block;height:100%;width:100%}.product-card[_ngcontent-%COMP%]{position:relative;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 2px 8px #0000000f;transition:transform .2s,box-shadow .2s;display:flex;flex-direction:column;height:100%;width:100%;cursor:pointer}.product-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 4px 16px #0000001f}.discount-tag[_ngcontent-%COMP%]{position:absolute;top:8px;left:8px;background:#ef4444;color:#fff;font-size:12px;font-weight:700;padding:4px 8px;border-radius:4px;z-index:2;line-height:1.2}.card-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;padding:12px}.card-image-container[_ngcontent-%COMP%]{height:160px;width:100%;display:flex;align-items:center;justify-content:center;padding:10px;background:#fafafa;flex-shrink:0}.card-img[_ngcontent-%COMP%]{max-width:100%;max-height:100%;object-fit:contain;object-position:center}.product-title[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:var(--text-primary);margin:12px 0 8px;line-height:1.4;display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;min-height:3em;height:2.8em;flex-shrink:0}.card-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:12px 16px 16px;gap:12px;flex-shrink:0;margin-top:auto}.price-block[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px;flex:1;min-width:0}.old-price[_ngcontent-%COMP%]{text-decoration:line-through;color:var(--text-secondary);font-size:.9rem;line-height:1.2}.current-price[_ngcontent-%COMP%]{color:var(--primary);font-weight:700;font-size:1.1rem;line-height:1.2}.btn-quick-add[_ngcontent-%COMP%]{background-color:var(--primary)!important;color:#fff!important;width:40px!important;height:40px!important;min-width:40px!important;min-height:40px!important;border-radius:50%!important;flex-shrink:0;transition:all .2s;display:flex!important;align-items:center!important;justify-content:center!important;padding:0!important;margin:0!important}.btn-quick-add[_ngcontent-%COMP%]:hover{background-color:var(--primary-dark)!important;transform:scale(1.1)}.btn-quick-add[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff!important;font-size:20px!important;width:20px!important;height:20px!important;line-height:20px!important;margin:0!important;padding:0!important}@media (max-width: 768px){.card-image-container[_ngcontent-%COMP%]{height:140px;padding:12px}.product-title[_ngcontent-%COMP%]{font-size:13px;margin:10px 12px 8px;min-height:2.8em;height:2.6em}.card-footer[_ngcontent-%COMP%]{padding:10px 12px 12px}.current-price[_ngcontent-%COMP%]{font-size:1rem}.old-price[_ngcontent-%COMP%]{font-size:.85rem}.btn-quick-add[_ngcontent-%COMP%]{width:36px!important;height:36px!important;min-width:36px!important;min-height:36px!important;display:flex!important;align-items:center!important;justify-content:center!important;padding:0!important}.btn-quick-add[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px!important;width:18px!important;height:18px!important;line-height:18px!important;margin:0!important;padding:0!important}}@media (max-width: 480px){.card-image-container[_ngcontent-%COMP%]{height:120px;padding:10px}.product-title[_ngcontent-%COMP%]{font-size:12px;margin:8px 10px;min-height:2.6em;height:2.4em}.card-footer[_ngcontent-%COMP%]{padding:8px 10px 10px}.current-price[_ngcontent-%COMP%]{font-size:.95rem}.old-price[_ngcontent-%COMP%]{font-size:.8rem}.discount-tag[_ngcontent-%COMP%]{font-size:11px;padding:3px 6px;top:6px;left:6px}}"]})};export{B as a};
