import{Yc as p,Zc as f,a as l,aa as m,c as b,cd as h,ga as _,la as g}from"./chunk-AFGHNMPW.js";var P=class u{constructor(o){this.http=o}apiUrl=`${h.apiUrl}/admin/products`;getProducts(o={}){let e=new p;return Object.entries(o).forEach(([n,c])=>{c!=null&&(e=e.set(n,c.toString()))}),this.http.get(this.apiUrl,{params:e})}getProduct(o){return this.http.get(`${this.apiUrl}/${o}`)}createProduct(o){let e=l({},o);["price","original_price","current_stock","min_stock","doses_por_garrafa","dose_price","category_id"].forEach(i=>{e[i]!==void 0&&e[i]!==null&&e[i]!==""?e[i]=Number(e[i]):e[i]===""&&(i==="original_price"||i==="dose_price")&&(e[i]=null)}),e.barcode===""&&(e.barcode=null),["is_active","visible_online","featured","offers","popular","can_sell_by_dose"].forEach(i=>{e[i]!==void 0&&(e[i]=e[i]===!0||e[i]==="true"||e[i]===1||e[i]==="1")});let r=new FormData;return Object.entries(e).forEach(([i,a])=>{a!=null&&(i==="image"&&a instanceof File?r.append("image",a,a.name):typeof a=="boolean"?r.append(i,a?"1":"0"):typeof a=="number"?r.append(i,a.toString()):r.append(i,String(a)))}),this.http.post(this.apiUrl,r)}updateProduct(o){let d=o,{id:e,image:n}=d,c=b(d,["id","image"]),r=l({},c),i=["name","description","category_id","price","current_stock","min_stock","doses_por_garrafa"];if(r.category_id!==void 0&&r.category_id!==null&&r.category_id!==""?r.category_id=Number(r.category_id):r.category_id,["price","current_stock","min_stock","doses_por_garrafa"].forEach(t=>{r[t]!==void 0&&r[t]!==null&&r[t]!==""&&(r[t]=Number(r[t]))}),["original_price","dose_price"].forEach(t=>{r[t]!==void 0&&r[t]!==null&&r[t]!==""?r[t]=Number(r[t]):r[t]===""&&(r[t]=null)}),r.barcode!==void 0&&r.barcode===""&&(r.barcode=null),["is_active","visible_online","featured","offers","popular","can_sell_by_dose"].forEach(t=>{r[t]!==void 0&&(r[t]=r[t]===!0||r[t]==="true"||r[t]===1||r[t]==="1")}),n instanceof File)return this.uploadImage(e,n).pipe(m(()=>{let t=l({},r);return t.barcode===null&&delete t.barcode,t.original_price===null&&delete t.original_price,t.dose_price===null&&delete t.dose_price,this.http.put(`${this.apiUrl}/${e}`,t)}));let s=l({},r);return s.barcode===null&&delete s.barcode,s.original_price===null&&delete s.original_price,s.dose_price===null&&delete s.dose_price,this.http.put(`${this.apiUrl}/${e}`,s)}deleteProduct(o){return this.http.delete(`${this.apiUrl}/${o}`)}toggleStatus(o){return this.http.patch(`${this.apiUrl}/${o}/toggle-status`,{})}uploadImage(o,e){let n=new FormData;return n.append("image",e,e.name),this.http.post(`${this.apiUrl}/${o}/image`,n)}deleteImage(o){return this.http.delete(`${this.apiUrl}/${o}/image`)}validateBarcode(o,e){let n=new p().set("barcode",o);return e&&(n=n.set("exclude_id",e.toString())),this.http.get(`${this.apiUrl}/validate-barcode`,{params:n})}importProducts(o){let e=new FormData;return e.append("file",o),this.http.post(`${this.apiUrl}/import`,e)}exportProducts(o="xlsx"){return this.http.get(`${this.apiUrl}/export`,{params:{format:o},responseType:"blob"})}static \u0275fac=function(e){return new(e||u)(g(f))};static \u0275prov=_({token:u,factory:u.\u0275fac,providedIn:"root"})};export{P as a};
