import{a as Q}from"./chunk-QJXKGTWH.js";import{a as q}from"./chunk-6CSLPSMF.js";import{A as K,b as G,d as u,g as L,h as j,k as B,m as H,p as J,x as W,y as Y}from"./chunk-M22BVTMS.js";import{c as z,d as V,h as $}from"./chunk-4CKO2N7V.js";import{$a as v,Bb as o,Cb as r,Db as _,Ic as D,Kb as f,Lb as c,Rc as N,Wa as a,Wb as l,Yb as k,a as M,b as O,f as R,gb as A,lb as d,sb as s,ub as g,va as I,wa as T}from"./chunk-AFGHNMPW.js";function X(n,i){if(n&1&&(o(0,"div",31),l(1),r()),n&2){let t=c();a(),k(" ",t.error," ")}}function Z(n,i){n&1&&(o(0,"span"),l(1,"Nome \xE9 obrigat\xF3rio"),r())}function ee(n,i){n&1&&(o(0,"span"),l(1,"Nome deve ter no m\xEDnimo 3 caracteres"),r())}function te(n,i){if(n&1&&(o(0,"div",32),d(1,Z,2,0,"span",20)(2,ee,2,0,"span",20),r()),n&2){let t,e,m=c();a(),s("ngIf",(t=m.registerForm.get("name"))==null||t.errors==null?null:t.errors.required),a(),s("ngIf",(e=m.registerForm.get("name"))==null||e.errors==null?null:e.errors.minlength)}}function ne(n,i){n&1&&(o(0,"span"),l(1,"E-mail \xE9 obrigat\xF3rio"),r())}function re(n,i){n&1&&(o(0,"span"),l(1,"E-mail inv\xE1lido"),r())}function ie(n,i){if(n&1&&(o(0,"div",32),d(1,ne,2,0,"span",20)(2,re,2,0,"span",20),r()),n&2){let t,e,m=c();a(),s("ngIf",(t=m.registerForm.get("email"))==null||t.errors==null?null:t.errors.required),a(),s("ngIf",(e=m.registerForm.get("email"))==null||e.errors==null?null:e.errors.email)}}function oe(n,i){n&1&&(o(0,"span"),l(1,"Telefone \xE9 obrigat\xF3rio"),r())}function ae(n,i){n&1&&(o(0,"span"),l(1,"Telefone inv\xE1lido"),r())}function le(n,i){if(n&1&&(o(0,"div",32),d(1,oe,2,0,"span",20)(2,ae,2,0,"span",20),r()),n&2){let t,e,m=c();a(),s("ngIf",(t=m.registerForm.get("phone"))==null||t.errors==null?null:t.errors.required),a(),s("ngIf",(e=m.registerForm.get("phone"))==null||e.errors==null?null:e.errors.pattern)}}function se(n,i){n&1&&(o(0,"span"),l(1,"CPF/CNPJ \xE9 obrigat\xF3rio"),r())}function me(n,i){n&1&&(o(0,"span"),l(1,"Documento inv\xE1lido (deve ter 11 d\xEDgitos para CPF ou 14 d\xEDgitos para CNPJ)"),r())}function de(n,i){if(n&1&&(o(0,"div",32),d(1,se,2,0,"span",20)(2,me,2,0,"span",20),r()),n&2){let t,e,m=c();a(),s("ngIf",(t=m.registerForm.get("document_number"))==null||t.errors==null?null:t.errors.required),a(),s("ngIf",(e=m.registerForm.get("document_number"))==null||e.errors==null?null:e.errors.invalidDocument)}}function ue(n,i){n&1&&(o(0,"span"),l(1,"Senha \xE9 obrigat\xF3ria"),r())}function pe(n,i){n&1&&(o(0,"span"),l(1,"Senha deve ter no m\xEDnimo 8 caracteres"),r())}function ce(n,i){if(n&1&&(o(0,"div",32),d(1,ue,2,0,"span",20)(2,pe,2,0,"span",20),r()),n&2){let t,e,m=c();a(),s("ngIf",(t=m.registerForm.get("password"))==null||t.errors==null?null:t.errors.required),a(),s("ngIf",(e=m.registerForm.get("password"))==null||e.errors==null?null:e.errors.minlength)}}function ge(n,i){n&1&&(o(0,"span"),l(1,"Confirma\xE7\xE3o de senha \xE9 obrigat\xF3ria"),r())}function _e(n,i){n&1&&(o(0,"span"),l(1,"As senhas n\xE3o conferem"),r())}function ve(n,i){if(n&1&&(o(0,"div",32),d(1,ge,2,0,"span",20)(2,_e,2,0,"span",20),r()),n&2){let t,e=c();a(),s("ngIf",(t=e.registerForm.get("password_confirmation"))==null||t.errors==null?null:t.errors.required),a(),s("ngIf",e.registerForm.errors==null?null:e.registerForm.errors.mismatch)}}function fe(n,i){n&1&&(o(0,"span"),l(1,"Criar conta"),r())}function he(n,i){n&1&&(o(0,"span"),l(1,"Criando conta..."),r())}var U=class n{constructor(i,t,e,m){this.fb=i;this.authService=t;this.socialAuthService=e;this.router=m;this.registerForm=this.fb.group({name:["",[u.required,u.minLength(3)]],email:["",[u.required,u.email]],phone:["",[u.required,u.pattern(/^\(\d{2}\) \d{5}-\d{4}$/)]],document_number:["",[u.required,p=>this.documentValidator(p)]],password:["",[u.required,u.minLength(8)]],password_confirmation:["",[u.required]]},{validators:this.passwordMatchValidator}),this.initializeSocialAuth(),window.addEventListener("social-auth-success",this.handleSocialAuthSuccess.bind(this)),window.addEventListener("social-auth-error",this.handleSocialAuthError.bind(this))}registerForm;loading=!1;error=null;ngOnDestroy(){window.removeEventListener("social-auth-success",this.handleSocialAuthSuccess.bind(this)),window.removeEventListener("social-auth-error",this.handleSocialAuthError.bind(this))}initializeSocialAuth(){return R(this,null,function*(){try{yield this.socialAuthService.initializeGoogle()}catch(i){console.error("Erro ao inicializar autentica\xE7\xE3o social:",i)}})}loginWithGoogle(){this.loading=!0,this.error=null,window.google&&window.google.accounts&&window.google.accounts.id.prompt()}handleSocialAuthSuccess(i){let t=i.detail;this.authService.saveAuth(t),this.router.navigate(["/"]),this.loading=!1}handleSocialAuthError(i){this.error="Erro na autentica\xE7\xE3o social. Tente novamente.",this.loading=!1}passwordMatchValidator(i){return i.get("password")?.value===i.get("password_confirmation")?.value?null:{mismatch:!0}}documentValidator(i){if(!i.value)return null;let t=i.value.replace(/\D/g,"");return t.length===11||t.length===14?null:{invalidDocument:!0}}onSubmit(){if(this.registerForm.invalid)return;this.loading=!0,this.error=null;let i=O(M({},this.registerForm.value),{document_number:this.registerForm.value.document_number.replace(/\D/g,"")});this.authService.register(i).subscribe({next:()=>{this.router.navigate(["/"])},error:t=>{if(t.error.errors){let e=Object.values(t.error.errors).flat();this.error=e.join(". ")}else this.error=t.error.message||"Erro ao criar conta";this.loading=!1}})}formatPhone(i){let t=i.target.value.replace(/\D/g,"");t.length<=11&&(t=t.replace(/^(\d{2})(\d{5})(\d{4}).*/,"($1) $2-$3"),this.registerForm.get("phone")?.setValue(t,{emitEvent:!1}))}formatDocument(i){let t=i.target.value.replace(/\D/g,"");t.length<=11?t=t.replace(/^(\d{3})(\d{3})(\d{3})(\d{2}).*/,"$1.$2.$3-$4"):t.length<=14&&(t=t.replace(/^(\d{2})(\d{3})(\d{3})(\d{4})(\d{2}).*/,"$1.$2.$3/$4-$5")),this.registerForm.get("document_number")?.setValue(t,{emitEvent:!1})}static \u0275fac=function(t){return new(t||n)(v(Y),v(q),v(Q),v(z))};static \u0275cmp=A({type:n,selectors:[["app-register"]],decls:58,vars:24,consts:[[1,"auth-container"],[1,"auth-card"],[1,"auth-header"],[1,"auth-form",3,"ngSubmit","formGroup"],["class","error-message",4,"ngIf"],[1,"form-group"],["for","name"],["type","text","id","name","formControlName","name","placeholder","Seu nome completo"],["class","error-hint",4,"ngIf"],["for","email"],["type","email","id","email","formControlName","email","placeholder","Seu e-mail"],["for","phone"],["type","text","id","phone","formControlName","phone","placeholder","(00) 00000-0000",3,"input"],["for","document_number"],["type","text","id","document_number","formControlName","document_number","placeholder","000.000.000-00 ou 00.000.000/0000-00","maxlength","18",3,"input"],["for","password"],["type","password","id","password","formControlName","password","placeholder","Sua senha"],["for","password_confirmation"],["type","password","id","password_confirmation","formControlName","password_confirmation","placeholder","Confirme sua senha"],["type","submit",1,"submit-button",3,"disabled"],[4,"ngIf"],[1,"social-divider"],[1,"social-login"],["type","button",1,"social-button","google-button",3,"click","disabled"],["viewBox","0 0 24 24",1,"social-icon"],["fill","#4285F4","d","M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"],["fill","#34A853","d","M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"],["fill","#FBBC05","d","M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"],["fill","#EA4335","d","M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"],[1,"auth-links"],["routerLink","/login"],[1,"error-message"],[1,"error-hint"]],template:function(t,e){if(t&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),l(4,"Criar Conta"),r(),o(5,"p"),l(6,"Cadastre-se para fazer seus pedidos"),r()(),o(7,"form",3),f("ngSubmit",function(){return e.onSubmit()}),d(8,X,2,1,"div",4),o(9,"div",5)(10,"label",6),l(11,"Nome completo"),r(),_(12,"input",7),d(13,te,3,2,"div",8),r(),o(14,"div",5)(15,"label",9),l(16,"E-mail"),r(),_(17,"input",10),d(18,ie,3,2,"div",8),r(),o(19,"div",5)(20,"label",11),l(21,"Telefone"),r(),o(22,"input",12),f("input",function(p){return e.formatPhone(p)}),r(),d(23,le,3,2,"div",8),r(),o(24,"div",5)(25,"label",13),l(26,"CPF ou CNPJ (somente n\xFAmeros)"),r(),o(27,"input",14),f("input",function(p){return e.formatDocument(p)}),r(),d(28,de,3,2,"div",8),r(),o(29,"div",5)(30,"label",15),l(31,"Senha"),r(),_(32,"input",16),d(33,ce,3,2,"div",8),r(),o(34,"div",5)(35,"label",17),l(36,"Confirmar senha"),r(),_(37,"input",18),d(38,ve,3,2,"div",8),r(),o(39,"button",19),d(40,fe,2,0,"span",20)(41,he,2,0,"span",20),r(),o(42,"div",21)(43,"span"),l(44,"ou"),r()(),o(45,"div",22)(46,"button",23),f("click",function(){return e.loginWithGoogle()}),I(),o(47,"svg",24),_(48,"path",25)(49,"path",26)(50,"path",27)(51,"path",28),r(),l(52," Entrar com Google "),r()(),T(),o(53,"div",29)(54,"p"),l(55,"J\xE1 tem uma conta? "),o(56,"a",30),l(57,"Fa\xE7a login"),r()()()()()()),t&2){let m,p,h,b,C,x,E,S,F,y,w,P;a(7),s("formGroup",e.registerForm),a(),s("ngIf",e.error),a(4),g("invalid",((m=e.registerForm.get("name"))==null?null:m.invalid)&&((m=e.registerForm.get("name"))==null?null:m.touched)),a(),s("ngIf",((p=e.registerForm.get("name"))==null?null:p.invalid)&&((p=e.registerForm.get("name"))==null?null:p.touched)),a(4),g("invalid",((h=e.registerForm.get("email"))==null?null:h.invalid)&&((h=e.registerForm.get("email"))==null?null:h.touched)),a(),s("ngIf",((b=e.registerForm.get("email"))==null?null:b.invalid)&&((b=e.registerForm.get("email"))==null?null:b.touched)),a(4),g("invalid",((C=e.registerForm.get("phone"))==null?null:C.invalid)&&((C=e.registerForm.get("phone"))==null?null:C.touched)),a(),s("ngIf",((x=e.registerForm.get("phone"))==null?null:x.invalid)&&((x=e.registerForm.get("phone"))==null?null:x.touched)),a(4),g("invalid",((E=e.registerForm.get("document_number"))==null?null:E.invalid)&&((E=e.registerForm.get("document_number"))==null?null:E.touched)),a(),s("ngIf",((S=e.registerForm.get("document_number"))==null?null:S.invalid)&&((S=e.registerForm.get("document_number"))==null?null:S.touched)),a(4),g("invalid",((F=e.registerForm.get("password"))==null?null:F.invalid)&&((F=e.registerForm.get("password"))==null?null:F.touched)),a(),s("ngIf",((y=e.registerForm.get("password"))==null?null:y.invalid)&&((y=e.registerForm.get("password"))==null?null:y.touched)),a(4),g("invalid",((w=e.registerForm.get("password_confirmation"))==null?null:w.invalid)&&((w=e.registerForm.get("password_confirmation"))==null?null:w.touched)||(e.registerForm.errors==null?null:e.registerForm.errors.mismatch)),a(),s("ngIf",((P=e.registerForm.get("password_confirmation"))==null?null:P.invalid)&&((P=e.registerForm.get("password_confirmation"))==null?null:P.touched)||(e.registerForm.errors==null?null:e.registerForm.errors.mismatch)),a(),s("disabled",e.registerForm.invalid||e.loading),a(),s("ngIf",!e.loading),a(),s("ngIf",e.loading),a(5),s("disabled",e.loading)}},dependencies:[N,D,$,V,K,B,G,L,j,W,H,J],styles:['.auth-container[_ngcontent-%COMP%]{min-height:calc(100vh - 64px);display:flex;align-items:center;justify-content:center;padding:2rem;background-color:var(--background)}.auth-card[_ngcontent-%COMP%]{width:100%;max-width:400px;background:var(--white);border-radius:var(--border-radius-md);box-shadow:0 2px 4px #0000001a;padding:2rem}.auth-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem}.auth-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.75rem;color:var(--text-primary);margin-bottom:.5rem}.auth-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-secondary)}.auth-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}label[_ngcontent-%COMP%]{font-size:.9rem;font-weight:500;color:var(--text-primary)}input[_ngcontent-%COMP%]{padding:.75rem 1rem;border:1px solid #ddd;border-radius:var(--border-radius-sm);font-size:1rem;transition:border-color .2s;color:var(--text-primary)}input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary)}input.invalid[_ngcontent-%COMP%]{border-color:#dc3545}.error-hint[_ngcontent-%COMP%]{font-size:.8rem;color:#dc3545}.error-message[_ngcontent-%COMP%]{padding:1rem;background-color:#fff5f5;border:1px solid #fed7d7;border-radius:var(--border-radius-sm);color:#dc3545;font-size:.9rem;text-align:center}.submit-button[_ngcontent-%COMP%]{padding:1rem;background-color:var(--primary);color:var(--secondary);border:none;border-radius:var(--border-radius-md);font-weight:600;cursor:pointer;transition:background-color .2s}.submit-button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--primary-dark)}.submit-button[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed;opacity:.6}.auth-links[_ngcontent-%COMP%]{text-align:center;font-size:.9rem;color:var(--text-secondary)}.auth-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--primary);text-decoration:none;font-weight:500;transition:color .2s}.auth-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--primary-dark);text-decoration:underline}.social-divider[_ngcontent-%COMP%]{position:relative;text-align:center;margin:1.5rem 0}.social-divider[_ngcontent-%COMP%]:before{content:"";position:absolute;top:50%;left:0;right:0;height:1px;background-color:#ddd}.social-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background-color:var(--white);padding:0 1rem;color:var(--text-secondary);font-size:.9rem}.social-login[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.social-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.75rem;padding:.75rem 1rem;border:1px solid #ddd;border-radius:var(--border-radius-sm);background-color:var(--white);color:var(--text-primary);font-weight:500;cursor:pointer;transition:all .2s;text-decoration:none}.social-button[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 2px 4px #0000001a;transform:translateY(-1px)}.social-button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.google-button[_ngcontent-%COMP%]{border-color:#dadce0}.google-button[_ngcontent-%COMP%]:hover:not(:disabled){border-color:#4285f4;box-shadow:0 2px 4px #4285f41a}.social-icon[_ngcontent-%COMP%]{width:20px;height:20px;flex-shrink:0}@media (max-width: 480px){.auth-container[_ngcontent-%COMP%]{padding:1rem}.auth-card[_ngcontent-%COMP%]{padding:1.5rem}.social-button[_ngcontent-%COMP%]{padding:.875rem 1rem;font-size:.9rem}}']})};export{U as RegisterComponent};
