import{Yc as d,Zc as u,a as o,b as n,cd as l,ga as p,la as s}from"./chunk-G6OUGGHL.js";var c=class a{constructor(e){this.http=e}apiUrl=`${l.apiUrl}/admin/combos`;getCombos(e){let r=new d;return e&&Object.keys(e).forEach(t=>{e[t]!==void 0&&e[t]!==null&&(r=r.set(t,e[t].toString()))}),this.http.get(this.apiUrl,{params:r})}getCombo(e){return this.http.get(`${this.apiUrl}/${e}`)}createCombo(e){if(e.images&&e.images.length>0){let t=this.createFormData(e);return console.log("Enviando FormData com imagens"),this.http.post(this.apiUrl,t)}let r=n(o({},e),{price:Number(e.price),original_price:e.original_price?Number(e.original_price):void 0,discount_percentage:e.discount_percentage?Number(e.discount_percentage):void 0,products:e.products.map(t=>({product_id:Number(t.product_id),quantity:Number(t.quantity),sale_type:t.sale_type}))});return delete r.images,console.log("Dados que ser\xE3o enviados (JSON):",r),this.http.post(this.apiUrl,r)}updateCombo(e,r){if(r.images&&r.images.length>0){let i=this.createFormData(r);return i.append("_method","PUT"),console.log("Enviando FormData com imagens para atualiza\xE7\xE3o (method spoofing)"),this.http.post(`${this.apiUrl}/${e}`,i)}let t=o({},r);return t.price!==void 0&&(t.price=Number(t.price)),t.original_price!==void 0&&(t.original_price=t.original_price?Number(t.original_price):void 0),t.discount_percentage!==void 0&&(t.discount_percentage=t.discount_percentage?Number(t.discount_percentage):void 0),t.products&&Array.isArray(t.products)&&(t.products=t.products.map(i=>({product_id:Number(i.product_id),quantity:Number(i.quantity),sale_type:i.sale_type}))),delete t.images,console.log("Dados que ser\xE3o enviados para atualiza\xE7\xE3o (JSON):",t),this.http.put(`${this.apiUrl}/${e}`,t)}deleteCombo(e){return this.http.delete(`${this.apiUrl}/${e}`)}toggleStatus(e){return this.http.patch(`${this.apiUrl}/${e}/toggle-status`,{})}uploadImage(e,r){let t=new FormData;return t.append("image",r),this.http.post(`${this.apiUrl}/${e}/image`,t)}deleteImage(e,r){return this.http.delete(`${this.apiUrl}/${e}/image`,{body:{image_url:r}})}validateBarcode(e){return this.http.get(`${this.apiUrl}/validate-barcode`,{params:{barcode:e}})}getProducts(){return this.http.get(`${this.apiUrl}/products`)}calculatePrice(e,r){let t=e.map(i=>({product_id:String(i.product_id),quantity:String(i.quantity),sale_type:i.sale_type}));return this.http.post(`${this.apiUrl}/calculate-price`,{products:t,discount_percentage:r})}createFormData(e){let r=new FormData;return r.append("name",e.name),e.description&&r.append("description",e.description),r.append("price",e.price.toString()),e.original_price&&r.append("original_price",e.original_price.toString()),e.discount_percentage&&r.append("discount_percentage",e.discount_percentage.toString()),e.barcode&&r.append("barcode",e.barcode),r.append("is_active",e.is_active?"1":"0"),r.append("featured",e.featured?"1":"0"),r.append("offers",e.offers?"1":"0"),r.append("popular",e.popular?"1":"0"),e.products&&e.products.length>0&&e.products.forEach((t,i)=>{r.append(`products[${i}][product_id]`,t.product_id.toString()),r.append(`products[${i}][quantity]`,t.quantity.toString()),r.append(`products[${i}][sale_type]`,t.sale_type)}),e.images&&e.images.forEach((t,i)=>{r.append(`images[${i}]`,t)}),r}static \u0275fac=function(r){return new(r||a)(s(u))};static \u0275prov=p({token:a,factory:a.\u0275fac,providedIn:"root"})};export{c as a};
